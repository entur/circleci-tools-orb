description: |
  Create a Entur-tag, create a docker image and push it to GCR.
executor: << parameters.executor >>
parameters:
  executor:
    description: The name of custom executor to use
    type: executor
    default: default
  tag_latest:
    description: Should the docker image also be tagged with the 'latest' tag?
    type: boolean
    default: false
steps:
  - checkout
  - shorten-branch-name:
      branch-name: $CIRCLE_BRANCH
  - create-entur-tag:
      branch-name: $SHORT_BRANCH_NAME
  - create-docker-image:
      tag_latest: << parameters.tag_latest >>
  - push-docker-image:
      tag_latest: << parameters.tag_latest >>
